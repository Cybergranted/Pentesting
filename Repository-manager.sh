#!/bin/bash

# Paths
PACMAN_CONF="/etc/pacman.conf"

# ArcoLinux Repository Sections
ARCO_REPOS=(
    "arcolinux_repo"
    "arcolinux_repo_3party"
    "arcolinux_repo_xlarge"
)

# Functions for BlackArch
enable_blackarch() {
    echo "Enabling BlackArch repository..."

    # Uncomment the BlackArch repository
    sudo sed -i '/#\[blackarch\]/s/#\[blackarch\]/\[blackarch\]/' "$PACMAN_CONF"
    sudo sed -i '/#Include = \/etc\/pacman.d\/blackarch-mirrorlist/s/#Include = \/etc\/pacman.d\/blackarch-mirrorlist/Include = \/etc\/pacman.d\/blackarch-mirrorlist/' "$PACMAN_CONF"

    # Update the package databases
    sudo pacman -Syyu --noconfirm

    echo "BlackArch repository enabled and updated."
}

disable_blackarch() {
    echo "Disabling BlackArch repository..."

    # Comment out the BlackArch repository
    sudo sed -i '/\[blackarch\]/s/\[blackarch\]/#\[blackarch\]/' "$PACMAN_CONF"
    sudo sed -i '/Include = \/etc\/pacman.d\/blackarch-mirrorlist/s/Include = \/etc\/pacman.d\/blackarch-mirrorlist/#Include = \/etc\/pacman.d\/blackarch-mirrorlist/' "$PACMAN_CONF"

    # Update the package databases
    sudo pacman -Sy

    echo "BlackArch repository disabled."
}

# Functions for ArcoLinux Repositories
enable_arcolinux_repo() {
    local repo=$1
    echo "Enabling $repo repository..."

    # Uncomment the ArcoLinux repository section
    sudo sed -i "/#\[$repo\]/s/#\[$repo\]/\[$repo\]/" "$PACMAN_CONF"
    sudo sed -i "/#Include = \/etc\/pacman.d\/arcolinux-mirrorlist/s/#Include = \/etc\/pacman.d\/arcolinux-mirrorlist/Include = \/etc\/pacman.d\/arcolinux-mirrorlist/" "$PACMAN_CONF"

    # Update the package databases
    sudo pacman -Syyu --noconfirm

    echo "$repo repository enabled and updated."
}

disable_arcolinux_repo() {
    local repo=$1
    echo "Disabling $repo repository..."

    # Comment out the ArcoLinux repository section
    sudo sed -i "/\[$repo\]/s/\[$repo\]/#\[$repo\]/" "$PACMAN_CONF"
    sudo sed -i "/Include = \/etc\/pacman.d\/arcolinux-mirrorlist/s/Include = \/etc\/pacman.d\/arcolinux-mirrorlist/#Include = \/etc\/pacman.d\/arcolinux-mirrorlist/" "$PACMAN_CONF"

    # Update the package databases
    sudo pacman -Sy

    echo "$repo repository disabled."
}

# Functions to enable/disable all ArcoLinux repositories
enable_arcolinux_repos() {
    for repo in "${ARCO_REPOS[@]}"; do
        enable_arcolinux_repo "$repo"
    done
}

disable_arcolinux_repos() {
    for repo in "${ARCO_REPOS[@]}"; do
        disable_arcolinux_repo "$repo"
    done
}

# Main menu
while true; do
    clear
    echo "Repository Management"
    echo "---------------------"
    echo "1. Enable BlackArch Repository"
    echo "2. Disable BlackArch Repository"
    echo "3. Enable ArcoLinux Repositories"
    echo "4. Disable ArcoLinux Repositories"
    echo "5. Exit"
    echo -n "Choose an option: "
    read -r option

    case $option in
        1)
            enable_blackarch
            ;;
        2)
            disable_blackarch
            ;;
        3)
            enable_arcolinux_repos
            ;;
        4)
            disable_arcolinux_repos
            ;;
        5)
            echo "Exiting..."
            exit 0
            ;;
        *)
            echo "Invalid option, please try again."
            ;;
    esac

    # Pause before showing the menu again
    echo -n "Press any key to continue..."
    read -r -n 1
done

